# Automated Floorplan Generation System

This system automatically generates professional floorplan images for all bounce houses using **GitHub Actions as the factory**.

## How It Works

### 1. Source of Truth: JSON Spec Files
Each bounce house has a spec file in `inflatables/` with:
- Dimensions (width, height, square footage)
- Entrance/exit location
- Blower pipe positions
- Anchor point placements
- Theme/color

Example: `inflatables/bull-dog-bounce-house.json`

### 2. Rendering Script
`scripts/render_floorplans.py` converts JSON → SVG with:
- Professional gradients and styling
- Dimension lines with arrows
- Anchor points (red circles)
- Blower connections
- Entrance/ramp indicators
- Theme-based colors (princess=pink, sports=green, etc.)

### 3. GitHub Actions Automation
`.github/workflows/render-floorplans.yml` triggers on:
- Any push to `inflatables/` folder
- Changes to rendering scripts
- Manual workflow dispatch

The workflow:
1. ✅ Generates SVG files
2. ✅ Converts to high-res PNG (1200x1200px)
3. ✅ Uploads artifacts (downloadable)
4. ✅ Commits images back to repo

## Usage

### Add a New Inflatable
1. Create JSON spec in `inflatables/your-bounce-house.json`
2. Commit and push
3. GitHub Actions automatically generates floorplan
4. Images appear in `output/floorplans/` (both SVG and PNG)

### Update Existing Inflatable
1. Edit the JSON spec file
2. Commit and push
3. Floorplan regenerates automatically

### Regenerate All Floorplans
```bash
# Local testing
python3 scripts/render_floorplans.py

# Force GitHub Actions to run
# Go to Actions tab → Render Floorplans → Run workflow
```

### Convert Products to Specs
```bash
python3 scripts/convert_products_to_specs.py
```

## Output

### SVG Files
- Vector format (scalable)
- Small file size (~4KB each)
- Perfect for web display
- Location: `output/floorplans/*.svg`

### PNG Files
- High resolution (1200x1200px)
- Suitable for print/PDF
- Generated by GitHub Actions
- Location: `output/floorplans/*.png`

## Customization

### Change Colors
Edit `theme_colors` in `render_floorplans.py`:
```python
theme_colors = {
    "princess": "#E75480",  # Pink
    "sports": "#228B22",    # Green  
    "character": "#FFB347",  # Orange
    "standard": "#3b6ea8"   # Blue
}
```

### Modify Layout
Edit the `svg_floorplan()` function to:
- Add/remove elements
- Change dimensions
- Adjust positioning
- Update styling

### Per-Inflatable Customization
Edit individual JSON files:
- `anchors` - Move anchor point positions
- `blower_pipes` - Change blower locations
- `entrance` / `ramp` - Adjust entry configuration
- `theme` - Override color scheme

## GitHub Actions Benefits

✅ **Zero Local Setup** - No Cairo/CairoSVG installation needed  
✅ **Consistent Output** - Same environment every time  
✅ **Automatic** - Runs on every push  
✅ **Version Controlled** - Images tracked in git  
✅ **Downloadable** - Artifacts available for 30 days  
✅ **Fast** - Generates 50 images in ~30 seconds  

## File Structure

```
yardproof/
├── inflatables/              # Source JSON specs (50 files)
│   ├── bull-dog-bounce-house.json
│   ├── princess-castle.json
│   └── ...
├── output/
│   └── floorplans/          # Generated images
│       ├── *.svg            # Vector graphics
│       └── *.png            # High-res rasters
├── scripts/
│   ├── convert_products_to_specs.py
│   └── render_floorplans.py
└── .github/workflows/
    └── render-floorplans.yml
```

## Notes

- Images auto-commit with `[skip ci]` to avoid infinite loops
- PNG conversion uses `rsvg-convert` (librsvg2-bin)
- SVGs are web-ready and can be embedded directly
- Workflow only commits on `main` branch pushes
